{% extends "layout.html" %}
{% block head%}
<link rel="stylesheet" href="../static/css/jquery-ui-1.8.11.custom.css" type="text/css" media="all"/>
<link rel="stylesheet" href="../static/css/retro.css" type="text/css" media="all"/>

<script type="text/javascript" src="../static/js/jquery.glob.js"></script>
<script type="text/javascript" src="../static/js/date.js"></script>
<script type="text/javascript" src="../static/js/jquery-ui-1.8.11.custom.min.js"></script>

<script type="text/javascript">
    $(function() {
        $("#accordion").accordion({
                    collapsible: true,
                    active:false
                });

        $("#new").click(function() {
            $("#new_form_dialog").dialog({
                        modal: true,
                        title: "Add New Retrospective",
                        width: 1000,
                        height: 800,
                        buttons: [
                            {
                                "text": "Save",
                                "class": "submit",
                                "click": function() {
                                    $("#new_form > input[name='retro_on']").val($.date().format("yyyy-MM-dd"));
                                    $("#new_form").submit();
                                }
                            },
                            {
                                "text": "Cancel",
                                "class": "cancel",
                                "click": function() {
                                    $(this).dialog("close");
                                }
                            }
                        ],
                        resizable: false,
                        draggable: false

                    });
        });

    });
</script>

{% endblock %}

{% block content %}
<article> <!-- The new article tag. The id is supplied so it can be scrolled into view. -->
    <h4>Retrospective</h4>
    <button id="new">New Retro</button>


    <div id="accordion">
        {% for retro in retros %}
        <h5><a href="#">{{retro.retro_on}}</a></h5>

        <div>
            <table>
                <tbody>
                <tr>
                    <td>Goal</td>
                    <td><pre>{{retro.goal}}</pre></td>
                </tr>
                <tr>
                    <td>Good</td>
                    <td><pre>{{retro.good}}</pre></td>
                </tr>
                <tr>
                    <td>Bad</td>
                    <td><pre>{{retro.bad}}</pre></td>
                </tr>
                <tr>
                    <td>Action</td>
                    <td><pre>{{retro.action}}</pre></td>
                </tr>
                </tbody>
            </table>

        </div>

        {% endfor %}

    </div>
</article>


<div  id="new_form_dialog" class="hidden">
    <form method="POST"  id="new_form" action="">
        <fieldset>
            <legend>Goal</legend>
            <textarea name="goal"></textarea>
        </fieldset>
        <fieldset>
            <legend>Good</legend>
            <textarea name="good"></textarea>
        </fieldset>
        <fieldset>
            <legend>Bad</legend>
            <textarea name="bad"></textarea>
        </fieldset>
        <fieldset>
            <legend>Action</legend>
            <textarea name="action"></textarea>
        </fieldset>
        <input class="hidden" name="retro_on" value=""/>
    </form>

</div>
{% endblock %}
